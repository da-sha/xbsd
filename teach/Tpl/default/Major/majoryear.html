<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<title>西北师大教务支持系统 - 专业计划课程管理</title>
		<link rel="stylesheet" type="text/css" href="../Public/css/style.css" />
		<script src="../Public/js/verify.js" type="text/javascript"></script>
		<script type="text/javascript" src="../Public/js/jquery.min.js"></script>
		<script type="text/javascript" src="../Public/js/jquery.artDialog.js?skin=default"></script>
		<script type="text/javascript" src="../Public/js/iframeTools.js?skin=default"></script>
		<script type="text/javascript">
			$(function(){
				$("#add_year_select_id").hide();
				$("#add_ok_button_id").hide();
				$("#majorid_id").change( function(){
					$("#year_id").html("<option value=''>---正在努力加载！---</option>") ;
					$.getJSON("__URL__/ajax_get_major_year/majorid/"+$(this).val(), function(data){
						if( data.status == 1 )
						{
							$("#year_id").empty();
							$.each(data.data, function(id,value){
								$("#year_id").append( "<option value='"+value.year+"'>"+value.year+"</option>");
							})
						}
						else
						{
							$("#year_id").html("<option value=''>---"+data.info+"---</option>") ;
						}
					}) ;
				}).ajaxError(function(){
					//
					art.dialog.tips( "ajax error" );
				});
				$("#addbutton_id").click(function(){
					$(this).hide() ;
					$("#add_year_select_id").show();
					$("#add_ok_button_id").show();
				}) ;
				$("#add_ok_button_id").click(function(){
					$.getJSON( "__URL__/ajax_insert_major_year/majorid/"+$("#majorid_id").val()+"/year/"+$("#add_year_select_id").val(), function(data){
						if( data.status == 1 )
						{
							//
							art.dialog.tips( data.info );
							$("#year_id").append( "<option value='"+$("#add_year_select_id").val()+"'>"+$("#add_year_select_id").val()+"</option>");
							$("#add_year_select_id").hide();
							$("#add_ok_button_id").hide();
							$("#addbutton_id").show();
						}
						else
						{
							//
							art.dialog.tips( data.info );
						}
					});
				}) ;

				$("#delbutton_id").click(function(){
					$.post("__URL__/delete_year", $("#major_year_id").serialize(), function(data){
						art.dialog.tips(data.info);
					},"json") ;
					$("#year_id option:selected").remove() ;
				}) ;
			});

		</script>
		</head>
		<body width="100%">
		<div class="mainbox">
			<form method='post' id="major_year_id">
				<table cellpadding=0 cellspacing=0 class="table_form" width="100%">
					<tr>
						<td  width="120">专业名称</td>
						<td>
							<select id="majorid_id" name="majorid">
								<option value="">--请选择专业--</option>
								<volist name="major_list" id="ma">
									<if condition="$major eq $ma[majorid]">
										<option value="{$ma['majorid']}" selected>{$ma[name]}</option>
										<else/>
										<option value="{$ma['majorid']}">{$ma[name]}</option>
									</if>
								</volist>
							</select>
							<select id="add_year_select_id" name="year">
								<option value="">---请选择学年---</option>
								<volist name="year_list" id="year">
									<option value="{$year['id']}">{$year["name"]}</option>
								</volist>
							</select>
							<input id="add_ok_button_id" type="button" value="确认" class="button" />
							<input id="addbutton_id" type="button" value="添加" class="button" />
						</td>
					</tr>
					<tr>
						<td  width="120">专业招生年</td>
						<td>
							<select multiple style="height: 200px;width: 200px;" id="year_id" name="major_year[]">
							</select>
							<input id="delbutton_id" type="button" value="删除" class="button" />
						</td>
					</tr>
				</table>
			</form>
		</div>
	</body>
</html>